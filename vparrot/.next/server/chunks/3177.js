"use strict";exports.id=3177,exports.ids=[3177],exports.modules={33177:(e,s,r)=>{r.r(s),r.d(s,{GET:()=>c,POST:()=>c,authOptions:()=>u});var a=r(3471),l=r.n(a),i=r(45955),t=r(53524),o=r(45952),n=r(67096),d=r.n(n);let m=new t.PrismaClient,p=o.ZP.object({email:o.ZP.string().email(),password:o.ZP.string().min(4)}),u={secret:process.env.NEXTAUTH_SECRET,session:{strategy:"jwt"},providers:[(0,i.Z)({name:"Email and Password",credentials:{email:{label:"Email",type:"email",placeholder:"hello@example.com"},password:{label:"Password",type:"password",placeholder:"********"}},async authorize(e){if(!p.safeParse(e).success||!e)return null;let s=await m.users.findUnique({where:{email:e.email}});if(!s)return null;let r=await d().compare(e.password,s.password);return r?{id:String(s.id),name:s.firstname,email:s.email,role:s.role}:null}})],callbacks:{jwt:({token:e,user:s})=>(s&&(e.role=s.role),e),session:({session:e,token:s,user:r})=>(e?.user&&(e.user.role=s?.role),e)}},c=l()(u)}};